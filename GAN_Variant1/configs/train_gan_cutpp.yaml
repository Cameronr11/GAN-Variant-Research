
image_size: 256
batch_size: 12
epochs: 70
max_steps: null

# Paths
data:
  photos_dir: "data/photo_jpg"
  monet_dir: "data/monet_jpg"
  photos_tfrec: "data/photo_tfrec"
  monet_tfrec: "data/monet_tfrec"

output:
  checkpoint_dir: "GAN_Variant1/checkpoints"
  log_dir: "GAN_Variant1/logs"


optim:
  G:
    lr: 2.0e-4
    betas: [0.5, 0.999]  
    weight_decay: 0.0
    scheduler:
      type: cosine
      lr_min: 5.0e-5
  D:
    lr: 2.0e-4
    betas: [0.5, 0.999]  
    weight_decay: 0.0
    scheduler:
      type: cosine
      lr_min: 5.0e-5

# Gradient clipping (safety net only)
grad_clip_g: 10.0
grad_clip_d: 10.0


loss_weights:
  adv: 1.0
  patchnce: 1.0
  identity_warm: 0.1
  identity_final: 0.0
  palette: 0.0  
  repulsion: 0.0  
  featmatch: 0.0 


warmup_steps: 20000


model:
  generator:
    base: "resnet9"
    n_downsampling: 2
    n_blocks: 9
    ngf: 64
    norm: "instance"
    activation: "relu"
    padding_type: "reflect"
    use_attention: false  
    use_channel_attn: false 
    use_style_dropout: false  
  
  discriminator:
    base: "patchgan"  
    num_scales: 1 
    ndf: 64
    n_layers: 3
    norm: "none"
    use_spectral_norm: false 
    receptive_field: 70


patchnce:
  num_patches: 256
  temperature: 0.07  
  nce_layers: [0, 4, 8, 12, 16]
  nce_includes_all_negatives_from_minibatch: false


diffaugment:
  enable: true
  policy: ["color", "translation", "cutout"]  


r1:
  gamma: 10.0  
  every: 16  


ema:
  decay: 0.999
  warmup_steps: 100


eval:
  every_steps: 500
  num_samples: 10


metrics:
  compute_fid: false
  compute_clip_distance: false
  eval_every: 500
  save_checkpoint_every: 2000


early_stop:
  enable: false
  patience: 5
  fid_plateau_threshold: 1.0
  dmin_drop_threshold: 0.01


checkpoint:
  every_steps: 2000
  keep_last_n: 5

# I/O
io:
  num_workers: 8
  pin_memory: true
  amp: true  


log:
  every_steps: 100
  verbose: true


clip_features:
  enabled: false
  backbone: "ViT-B/32"
  monet_feats_path: "GAN_Variant1/artifacts/features/monet_clip_vitb32.pt"
  margin_path: "GAN_Variant1/artifacts/faiss/distance_margin.json"
  build_on_first_run: false

  
palette:
  enabled: false

palette_prior:
  low_freq_size: 32
  use_ema: true
  ema_decay: 0.99


repulsion:
  enabled: false

